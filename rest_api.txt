import requests
import pandas as pd

# Example REST API (JSON placeholder fake API)
API_URL = "https://jsonplaceholder.typicode.com/users"

def fetch_data(api_url):
    """Fetch JSON data from REST API"""
    response = requests.get(api_url)
    response.raise_for_status()  # raise error if request fails
    return response.json()

def save_to_excel(data, filename="output.xlsx"):
    """Convert JSON to DataFrame and save as Excel"""
    df = pd.DataFrame(data)
    df.to_excel(filename, index=False)
    print(f"✅ Data saved to {filename}")

if __name__ == "__main__":
    try:
        json_data = fetch_data(API_URL)
        save_to_excel(json_data, "students_data.xlsx")
    except Exception as e:
        print("❌ Error:", e)
